{% extends "base.html" %}
{% block content %}

<!-- =========================
     PAGE HEADER
========================= -->
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h2>Job Seeker Dashboard</h2>
        <p class="text-muted mb-0">
            Welcome back, <strong>{{ user.name }}</strong>
        </p>
    </div>

    <a href="{{ url_for('jobs.jobs_list') }}"
       class="btn btn-primary">
        üîç Find Jobs
    </a>
</div>

<hr>

<!-- =========================
     DASHBOARD STATS (DYNAMIC)
========================= -->
<div class="row mb-4">

    <div class="col-md-4">
        <div class="card shadow-sm text-center">
            <div class="card-body">
                <h6 class="text-muted">Profile Status</h6>
                {% if profile_active %}
                    <span class="badge bg-success">Active</span>
                {% else %}
                    <span class="badge bg-warning">Incomplete</span>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card shadow-sm text-center">
            <div class="card-body">
                <h6 class="text-muted">Resume</h6>
                {% if resume_uploaded %}
                    <span class="badge bg-info">Uploaded</span>
                {% else %}
                    <span class="badge bg-danger">Not Uploaded</span>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card shadow-sm text-center">
            <div class="card-body">
                <h6 class="text-muted">ML Engine</h6>
                {% if ml_enabled %}
                    <span class="badge bg-success">Enabled</span>
                {% else %}
                    <span class="badge bg-secondary">Disabled</span>
                {% endif %}
            </div>
        </div>
    </div>

</div>

<!-- =========================
     ML JOB RECOMMENDATIONS
========================= -->
<h4 class="mt-4 mb-3">üéØ Recommended Jobs for You</h4>

{% if recommendations %}

<div class="table-responsive">
<table class="table table-bordered align-middle shadow-sm">
    <thead class="table-dark">
        <tr>
            <th>Job Role</th>
            <th>Company</th>
            <th>Match Score</th>
            <th>Action</th>
        </tr>
    </thead>

    <tbody>
        {% for rec in recommendations %}
        <tr>
            <td>{{ rec.job.title }}</td>
            <td>{{ rec.job.company.name }}</td>

            <!-- MATCH SCORE WITH COLOR LOGIC -->
            <td>
                {% if rec.match_percent >= 75 %}
                    <span class="badge bg-success">
                        {{ rec.match_percent }}%
                    </span>
                {% elif rec.match_percent >= 50 %}
                    <span class="badge bg-warning text-dark">
                        {{ rec.match_percent }}%
                    </span>
                {% else %}
                    <span class="badge bg-secondary">
                        {{ rec.match_percent }}%
                    </span>
                {% endif %}
            </td>

            <td>
                <a href="{{ url_for('jobs.job_detail', job_id=rec.job.id) }}"
                   class="btn btn-sm btn-outline-primary">
                    View Job
                </a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
</div>

{% else %}

<!-- =========================
     EMPTY STATE
========================= -->
<div class="alert alert-info mt-3">
    <h6 class="mb-1">No recommendations yet</h6>
    <p class="mb-2">
        Apply to at least one job with a resume to activate AI-based recommendations.
    </p>
    <a href="{{ url_for('jobs.jobs_list') }}"
       class="btn btn-sm btn-primary">
        Browse Jobs
    </a>
</div>

{% endif %}

{% endblock %}
